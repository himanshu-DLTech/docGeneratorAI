# This YAML file is the core of any AI application. The ID in the file, the file name and the hosting folder must
# match. The file documents rest of the commands and syntax.

---
id: docaiapp            # the AI application name / ID
interface:                                  # the interface details
  type: enterpriseassist                    # this is for the frontend can be chat, translate or search interfaces
  label: DOCUMENT AI                       # the label for the app icon on the UI
  icon: data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cGF0aCBkPSJNNTIuMDgzMyAxNi42NjY3SDQ3LjkxNjdWMjkuMTY2N0g1Mi4wODMzVjE2LjY2NjdaIiBmaWxsPSJ1cmwoI3BhaW50MF9saW5lYXJfNDA4XzI2KSIvPg0KPHBhdGggZD0iTTEyLjUgNTYuMjVIMTYuNjY2NlY3Ny4wODMzSDEyLjVDMTEuMTMyIDc3LjA4MzMgOS43Nzc1IDc2LjgxMzkgOC41MTM2OSA3Ni4yOTA0QzcuMjQ5ODkgNzUuNzY2OSA2LjEwMTU2IDc0Ljk5OTYgNS4xMzQyOCA3NC4wMzI0QzMuMTgwNzggNzIuMDc4OSAyLjA4MzMxIDY5LjQyOTMgMi4wODMzMSA2Ni42NjY3QzIuMDgzMzEgNjMuOTA0IDMuMTgwNzggNjEuMjU0NSA1LjEzNDI4IDU5LjMwMUM3LjA4Nzc5IDU3LjM0NzUgOS43MzczMSA1Ni4yNSAxMi41IDU2LjI1WiIgZmlsbD0idXJsKCNwYWludDFfbGluZWFyXzQwOF8yNikiLz4NCjxwYXRoIGQ9Ik04My4zMzMzIDU2LjI1SDg3LjVDOTAuMjYyNyA1Ni4yNSA5Mi45MTIyIDU3LjM0NzUgOTQuODY1NyA1OS4zMDFDOTYuODE5MiA2MS4yNTQ1IDk3LjkxNjYgNjMuOTA0IDk3LjkxNjYgNjYuNjY2N0M5Ny45MTY2IDY5LjQyOTMgOTYuODE5MiA3Mi4wNzg5IDk0Ljg2NTcgNzQuMDMyNEM5Mi45MTIyIDc1Ljk4NTkgOTAuMjYyNyA3Ny4wODMzIDg3LjUgNzcuMDgzM0g4My4zMzMzVjU2LjI1WiIgZmlsbD0idXJsKCNwYWludDJfbGluZWFyXzQwOF8yNikiLz4NCjxwYXRoIGQ9Ik01MCAyNy4wODMzQzU5Ljk0NTYgMjcuMDgzMyA2OS40ODM5IDMxLjAzNDIgNzYuNTE2NSAzOC4wNjY4QzgzLjU0OTEgNDUuMDk5NCA4Ny41IDU0LjYzNzcgODcuNSA2NC41ODMzVjgxLjI1Qzg3LjUgODIuMzU1MSA4Ny4wNjEgODMuNDE0OSA4Ni4yNzk2IDg0LjE5NjNDODUuNDk4MiA4NC45Nzc3IDg0LjQzODQgODUuNDE2NyA4My4zMzMzIDg1LjQxNjdIMTYuNjY2N0MxNS41NjE2IDg1LjQxNjcgMTQuNTAxOCA4NC45Nzc3IDEzLjcyMDQgODQuMTk2M0MxMi45MzkgODMuNDE0OSAxMi41IDgyLjM1NTEgMTIuNSA4MS4yNVY2NC41ODMzQzEyLjUgNTQuNjM3NyAxNi40NTA5IDQ1LjA5OTQgMjMuNDgzNSAzOC4wNjY4QzMwLjUxNjEgMzEuMDM0MiA0MC4wNTQ0IDI3LjA4MzMgNTAgMjcuMDgzM1oiIGZpbGw9IiMxOTlCRTIiLz4NCjxwYXRoIGQ9Ik0zMy4zMzMzIDc3LjA4MzNDNDAuMjM2OSA3Ny4wODMzIDQ1LjgzMzMgNzEuNDg2OSA0NS44MzMzIDY0LjU4MzNDNDUuODMzMyA1Ny42Nzk4IDQwLjIzNjkgNTIuMDgzMyAzMy4zMzMzIDUyLjA4MzNDMjYuNDI5OCA1Mi4wODMzIDIwLjgzMzMgNTcuNjc5OCAyMC44MzMzIDY0LjU4MzNDMjAuODMzMyA3MS40ODY5IDI2LjQyOTggNzcuMDgzMyAzMy4zMzMzIDc3LjA4MzNaIiBmaWxsPSJ1cmwoI3BhaW50M19saW5lYXJfNDA4XzI2KSIvPg0KPHBhdGggZD0iTTY2LjY2NjcgNzcuMDgzM0M3My41NzAyIDc3LjA4MzMgNzkuMTY2NyA3MS40ODY5IDc5LjE2NjcgNjQuNTgzM0M3OS4xNjY3IDU3LjY3OTggNzMuNTcwMiA1Mi4wODMzIDY2LjY2NjcgNTIuMDgzM0M1OS43NjMxIDUyLjA4MzMgNTQuMTY2NyA1Ny42Nzk4IDU0LjE2NjcgNjQuNTgzM0M1NC4xNjY3IDcxLjQ4NjkgNTkuNzYzMSA3Ny4wODMzIDY2LjY2NjcgNzcuMDgzM1oiIGZpbGw9InVybCgjcGFpbnQ0X2xpbmVhcl80MDhfMjYpIi8+DQo8cGF0aCBkPSJNNjYuNjY2NyA3Mi45MTY3QzcxLjI2OSA3Mi45MTY3IDc1IDY5LjE4NTcgNzUgNjQuNTgzM0M3NSA1OS45ODEgNzEuMjY5IDU2LjI1IDY2LjY2NjcgNTYuMjVDNjIuMDY0MyA1Ni4yNSA1OC4zMzMzIDU5Ljk4MSA1OC4zMzMzIDY0LjU4MzNDNTguMzMzMyA2OS4xODU3IDYyLjA2NDMgNzIuOTE2NyA2Ni42NjY3IDcyLjkxNjdaIiBmaWxsPSJ3aGl0ZSIvPg0KPHBhdGggZD0iTTY2LjY2NjcgNjguNzVDNjguOTY3OSA2OC43NSA3MC44MzMzIDY2Ljg4NDUgNzAuODMzMyA2NC41ODMzQzcwLjgzMzMgNjIuMjgyMSA2OC45Njc5IDYwLjQxNjcgNjYuNjY2NyA2MC40MTY3QzY0LjM2NTUgNjAuNDE2NyA2Mi41IDYyLjI4MjEgNjIuNSA2NC41ODMzQzYyLjUgNjYuODg0NSA2NC4zNjU1IDY4Ljc1IDY2LjY2NjcgNjguNzVaIiBmaWxsPSJ1cmwoI3BhaW50NV9saW5lYXJfNDA4XzI2KSIvPg0KPHBhdGggZD0iTTMzLjMzMzMgNzIuOTE2N0MzNy45MzU3IDcyLjkxNjcgNDEuNjY2NyA2OS4xODU3IDQxLjY2NjcgNjQuNTgzM0M0MS42NjY3IDU5Ljk4MSAzNy45MzU3IDU2LjI1IDMzLjMzMzMgNTYuMjVDMjguNzMxIDU2LjI1IDI1IDU5Ljk4MSAyNSA2NC41ODMzQzI1IDY5LjE4NTcgMjguNzMxIDcyLjkxNjcgMzMuMzMzMyA3Mi45MTY3WiIgZmlsbD0id2hpdGUiLz4NCjxwYXRoIGQ9Ik0zMy4zMzMzIDY4Ljc1QzM1LjYzNDUgNjguNzUgMzcuNSA2Ni44ODQ1IDM3LjUgNjQuNTgzM0MzNy41IDYyLjI4MjEgMzUuNjM0NSA2MC40MTY3IDMzLjMzMzMgNjAuNDE2N0MzMS4wMzIxIDYwLjQxNjcgMjkuMTY2NyA2Mi4yODIxIDI5LjE2NjcgNjQuNTgzM0MyOS4xNjY3IDY2Ljg4NDUgMzEuMDMyMSA2OC43NSAzMy4zMzMzIDY4Ljc1WiIgZmlsbD0idXJsKCNwYWludDZfbGluZWFyXzQwOF8yNikiLz4NCjxwYXRoIGQ9Ik01MCAyMC44MzMzQzUyLjMwMTIgMjAuODMzMyA1NC4xNjY3IDE4Ljk2NzkgNTQuMTY2NyAxNi42NjY3QzU0LjE2NjcgMTQuMzY1NSA1Mi4zMDEyIDEyLjUgNTAgMTIuNUM0Ny42OTg4IDEyLjUgNDUuODMzMyAxNC4zNjU1IDQ1LjgzMzMgMTYuNjY2N0M0NS44MzMzIDE4Ljk2NzkgNDcuNjk4OCAyMC44MzMzIDUwIDIwLjgzMzNaIiBmaWxsPSIjMTk5QkUyIi8+DQo8ZGVmcz4NCjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQwX2xpbmVhcl80MDhfMjYiIHgxPSI1MCIgeTE9IjE4Ljk3NzEiIHgyPSI1MCIgeTI9IjI4LjI2NjciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4NCjxzdG9wIHN0b3AtY29sb3I9IiMwMDc3RDIiLz4NCjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzBCNTlBMiIvPg0KPC9saW5lYXJHcmFkaWVudD4NCjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQxX2xpbmVhcl80MDhfMjYiIHgxPSI5LjM3NDk4IiB5MT0iNTUuNjYwNCIgeDI9IjkuMzc0OTgiIHkyPSI4Ny4wNTQyIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+DQo8c3RvcCBzdG9wLWNvbG9yPSIjMDNCM0ZGIi8+DQo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMwQjU5QTIiLz4NCjwvbGluZWFyR3JhZGllbnQ+DQo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50Ml9saW5lYXJfNDA4XzI2IiB4MT0iOTAuNjI1IiB5MT0iNTUuNjYwNCIgeDI9IjkwLjYyNSIgeTI9Ijg3LjA1NDIiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4NCjxzdG9wIHN0b3AtY29sb3I9IiMwM0IzRkYiLz4NCjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzBCNTlBMiIvPg0KPC9saW5lYXJHcmFkaWVudD4NCjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQzX2xpbmVhcl80MDhfMjYiIHgxPSIzMy4zMzMzIiB5MT0iNTIuMTk1OCIgeDI9IjMzLjMzMzMiIHkyPSI5MC42MTQ2IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+DQo8c3RvcCBzdG9wLWNvbG9yPSIjMDA3N0QyIi8+DQo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMwQjU5QTIiLz4NCjwvbGluZWFyR3JhZGllbnQ+DQo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50NF9saW5lYXJfNDA4XzI2IiB4MT0iNjYuNjY2NyIgeTE9IjUyLjE5NTgiIHgyPSI2Ni42NjY3IiB5Mj0iOTAuNjE0NiIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPg0KPHN0b3Agc3RvcC1jb2xvcj0iIzAwNzdEMiIvPg0KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMEI1OUEyIi8+DQo8L2xpbmVhckdyYWRpZW50Pg0KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDVfbGluZWFyXzQwOF8yNiIgeDE9IjY2LjY2NjciIHkxPSI1Mi4xOTU4IiB4Mj0iNjYuNjY2NyIgeTI9IjkwLjYxNDYiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4NCjxzdG9wIHN0b3AtY29sb3I9IiMwM0IzRkYiLz4NCjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzBCNTlBMiIvPg0KPC9saW5lYXJHcmFkaWVudD4NCjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQ2X2xpbmVhcl80MDhfMjYiIHgxPSIzMy4zMzMzIiB5MT0iNTIuMTk1OCIgeDI9IjMzLjMzMzMiIHkyPSI5MC42MTQ2IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+DQo8c3RvcCBzdG9wLWNvbG9yPSIjMDNCM0ZGIi8+DQo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMwQjU5QTIiLz4NCjwvbGluZWFyR3JhZGllbnQ+DQo8L2RlZnM+DQo8L3N2Zz4NCg==
  skippable_file_patterns: 
    - ^_neuranet_generated?.+
    - ^\.system?.+
endpoint: llmflow                           # the API endpoint - usually llmflow
users: ["*"]                                # the * means all users, else must be an array of user IDs
admins: ["thecompany@tekmonks.com"]         # the admins for this app - they can train for example
api_uploads_cms_path: uploads               # where files are uploaded by index, unindex APIs
generated_files_path: _neuranet_generated   # where generated files are placed
ai_cost_quota: 0.6                          # cost quota for the users, -1 disables checks also
disable_quota_checks: true                  # disable quotas if true
disable_model_usage_logging: true           # if true, ai model usage logging
default_embeddings_model: embedding-openai  # model for embedding file ingestion
ingestiondbs: ["nntfidfdb", "nnvectordb"]   # the ingestion databases

# all flows are sequence of commands which follow the same syntax - command, in, out - in is the input
# to the command, out is the variable holding the output and name points to the command module and entry
# point. the command sytax is documented below as well.

llm_flow: 
  - command: llmgptchat                     # default function entry is answer so entry function name is skipped
    in: 
      session_id: "{{{request.session_id}}}" 
      auto_summary: false                   # controls session auto-summary, setting to true will lead to random errors but shorter sessions        
      question: "{{{query}}}"
      files_js: return request.files        # _js means evaluate Javascript to find the value
      aiappid: "{{{aiappid}}}"
      documentSchema: 
        tender: 
          rules: |  
            1.\nRole & Purpose:\nYou are an advanced AI assistant specialized in document generation. You can create any type of professional, personal, private, or government document, including tenders, resumes, proposals, leave applications, certificates, legal-style drafts, reports, and more. Your goal is to produce high-quality, well-structured, and contextually accurate documents tailored to the user’s needs.\n 2.\nCore Workflow:\n a.\nStep 1 – Identify the Task\nWhen the user requests a document, first determine what type it is (e.g., resume, tender, letter, application).\nThen identify the purpose, audience/recipient, and tone.\n b.\nStep 2 – Guided Questioning (One by One)\nIf essential details are missing, ask for them one at a time, in logical order.\nExample sequence for a formal letter:\nWho is the recipient?\nWhat is the subject or purpose of the document?\nWhat key details should be included (dates, amounts, positions, etc.)?\nWhat tone should be used (formal, polite, persuasive, neutral)?\nAfter each answer, confirm and move to the next detail until enough information is collected.\n c.\nStep 3 – Generate the Document\nProduce a clean, structured draft with:\nHeader (sender/recipient info, date)\nSubject line (if relevant)\nBody text (clear, professional, goal-oriented)\nClosing/signature\nIf details are missing, use placeholders [like this] and note them clearly.\n d.\nStep 4 – Optimize & Present\nEnsure grammar, clarity, and professional tone.\nSuggest optional variations (e.g., short vs. detailed version, formal vs. semi-formal tone).\nDeliver the final draft in copy-ready format, with clear markers for editable fields.\n 3.\nSafety & Boundaries:\nNever generate fraudulent, misleading, or harmful documents.\nDo not impersonate professionals (e.g., lawyers, doctors, financial advisors).\nAlways clarify that outputs are templates/drafts and may need user review before official use.\n 4.\nNote:\nAlways generate a very detailed document only based on user answers only.\nOnly ask one question at a time and never ask multiple questions at once.\nAlways acknowledgement with thinking ability of the answer recieved from user.\nAsk each and every details from the user and never use false information or hallucinate.\n  

          output_format: |  
            1.\nWhen generating the detailed document, output ONLY the detailed document itself with basic text formating like bold, italic etc.\n 2.\nNo preface or postscript.\n 3.\nDo NOT write acknowledgements, confirmations, apologies, or questions (e.g Thank you…, Below is…, Please review…, Would you like…).\n 4.\nBefore the actual heading add 'NEURANET GENERATED DOCUMENT' like 'NEURANET GENERATED DOCUMENT'\n<Actual Document Heading>.\n 
        announcement_letter: 
          rules: | 
            1. Role & Purpose: You are an advanced AI assistant specialized in document generation. You can create only government announcement documents. 2. Goal: Produce high-quality, well-structured, and contextually accurate announcement documents tailored to the user’s needs. 3. Step 1 – Identify the Task: Generate a Thai announcement document. Tone must be formal. 4. Step 2 – Guided Questioning: Accept any mix of complete or partial inputs. Deduce missing details safely. Interpret relative dates into concrete Thai solar calendar dates (YYYY-MM-DD BE). Ask only for missing or unclear details, one at a time, in plain readable Thai. Do not repeat questions. Update understanding if multiple fields are provided. Example sequence: Announcement by? Title? Location? Body? Date? Name for signing? Designation of signer? Confirm each answer and move to next. 5. Step 3 – JSON Output: Return JSON with fields announcementBy, title, location, body, dateOfIssuing, signedBy, designation only when all are non-empty. dateOfIssuing in Thai BE format DD MMMM YYYY. signedBy in brackets '(ชื่อผู้ลงนาม)'. If any field missing, ask a single Thai question before proceeding. Never ask other signer details. 6. Step 4 – Optimize & Present: Ensure grammar, clarity, professional tone. Suggest optional variations (short vs detailed, formal vs semi-formal). Deliver copy-ready document with basic formatting (bold/italic). 7. Safety & Boundaries: Never generate fraudulent, misleading, or harmful documents. Do not impersonate professionals. Clarify outputs are templates and may need review. 8. Notes: Generate detailed document only based on user answers. Output only the document itself. Do not include preface, postscript, acknowledgements, confirmations, apologies, or unnecessary questions. Always acknowledge received answers. All values must be in Thai. 9. Regeneration: If requested, return last JSON only, no extra text.
          output_format: | 
            JSON with fields: announcementBy, title, location, body, dateOfIssuing, signedBy, designation. dateOfIssuing in Thai BE format DD MMMM YYYY. signedBy in brackets '(ชื่อผู้ลงนาม)'. Output JSON only when all fields are provided.
        default:
          rules: |
            lksddvnksdnv
          output_format: |
            ldkvnvv dvd
      prompt_noinflate: |                   
        User Query: {{{question}}}

        Document Schema (JSON):
        ```
        {{{documentSchema}}}
        ```
      model: 
        name: simplellm-openai
    out: airesponse                         # the final response must output to this property - airesponse for LLM flows

  - command: decorater.formatResponse       # default function entry is answer so entry function name is skipped
    in: 
      airesponse_js: return airesponse;  
    out: airesponse

global_models:
  - name: simplellm-openai
    model_overrides:                    
      read_ai_response_from_samples: false
      system_message: You are an AI assistant designed to generate documents based on user needs. Your core tasks are - \n1. Accept user queries and the unified JSON schema provided.  \n2. Use the JSON schema where each key is a document type, and values contain rules, instructions, and the required output format.  \n3. If the user wants a document- \n- Ask clarifying questions one by one to gather the missing details.  \n  - Follow the rules and formatting instructions from the JSON schema strictly.  \n  - Generate the final document in the requested format.  \n4. If the user asks general questions (about documents, previous outputs, or related topics), answer them clearly without breaking the main goal.  \n5. Always remain structured, helpful, and aligned with the provided schema.\n\nEnd goal- Deliver a fully formatted document (e.g., HTML, plain text, PDF-like markup) that satisfies the schema and user’s request.